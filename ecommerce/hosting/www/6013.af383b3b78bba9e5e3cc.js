(self.webpackChunkcom_trackingsystem=self.webpackChunkcom_trackingsystem||[]).push([[6013],{6013:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Admintab1PageModule:()=>A});var r=n(8583),i=n(665),o=n(5214),a=n(6476),l=n(4762),s=n(8002),c=n(6738),d=n(2329),u=n(3018),m=n(7810),g=n(1562);function h(e,t){if(1&e&&(u.TgZ(0,"ion-item",14),u.TgZ(1,"ion-avatar",15),u._UZ(2,"img",16),u.qZA(),u.TgZ(3,"ion-label",17),u.TgZ(4,"h2",18),u._uU(5),u.qZA(),u.TgZ(6,"p",18),u._uU(7),u.qZA(),u.TgZ(8,"p",18),u._uU(9),u.ALo(10,"currency"),u.qZA(),u.qZA(),u.qZA()),2&e){const e=t.$implicit;u.xp6(2),u.s9C("src",e.ImageUrl,u.LSH),u.xp6(3),u.hij("Product Name: ",e.ProductName,""),u.xp6(2),u.hij("Quantity: ",e.Quantity,""),u.xp6(2),u.hij("Unit Price: ",u.xi3(10,4,e.UnitPrice,"\u20b1"),"")}}function p(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"ion-accordion"),u.TgZ(1,"ion-item",8),u.TgZ(2,"ion-label",9),u._uU(3),u._UZ(4,"br"),u._uU(5),u._UZ(6,"br"),u._uU(7),u._UZ(8,"br"),u._uU(9),u._UZ(10,"br"),u._uU(11),u._UZ(12,"br"),u._uU(13),u._UZ(14,"br"),u._uU(15),u._UZ(16,"br"),u._uU(17),u.ALo(18,"currency"),u.qZA(),u.qZA(),u.TgZ(19,"ion-list",10),u.YNc(20,h,11,7,"ion-item",11),u.TgZ(21,"ion-button",12),u.NdJ("click",function(){const t=u.CHM(e).$implicit;return u.oxw().approveOrder(t)}),u._uU(22,"Approve Order"),u.qZA(),u.TgZ(23,"ion-button",13),u.NdJ("click",function(){const t=u.CHM(e).$implicit;return u.oxw().cancelOrder(t)}),u._uU(24,"Cancel Order"),u.qZA(),u.qZA(),u.qZA()}if(2&e){const e=t.$implicit;u.xp6(3),u.AsE(" Fullname : ",e.BillingFirstname," ",e.BillingLastname," "),u.xp6(2),u.hij(" Email : ",e.Billingemail," "),u.xp6(2),u.hij(" Address : ",e.BillingAddress1," "),u.xp6(2),u.hij(" Phone Number: ",e.BillingPhonenumber," "),u.xp6(2),u.hij(" Date Ordered : ",e.Datetime," "),u.xp6(2),u.hij(" Discount : ",e.Discount," "),u.xp6(2),u.hij(" Payment : ",e.PaymentMethod," "),u.xp6(2),u.hij(" Total Amount : ",u.xi3(18,10,e.TotalAmount,"\u20b1")," "),u.xp6(3),u.Q6J("ngForOf",e.OrderDetails)}}const f=[{path:"",component:(()=>{class e{constructor(e,t,n,r,i){this.afstore=e,this.afauth=t,this.router=n,this.currencyPipe=r,this.alertCtrl=i,this.allPendingOrders=[],this.currentStock=[],this.afauth.authState.subscribe(e=>{e&&e.uid&&(this.productReference=this.afstore.collection("Orders",e=>e.where("Status","==","Open")),this.sub=this.productReference.snapshotChanges().pipe((0,s.U)(e=>e.map(e=>Object.assign({id:e.payload.doc.id},e.payload.doc.data())))).subscribe(e=>{console.log("orders",e),e=(e=e.map((e,t)=>Object.assign({BillingAddress1:e.BillingAddress1,BillingAddress2:e.BillingAddress2,BillingFirstname:e.BillingFirstname,BillingIndexId:e.BillingIndexId,BillingLastname:e.BillingLastname,BillingPhonenumber:e.BillingPhonenumber,Billingemail:e.Billingemail,Datetime:e.Datetime,Status:e.Status,TotalAmount:e.TotalAmount,id:e.id,DatetimeToSort:e.DatetimeToSort,OrderDetails:e.OrderDetails,Discount:e.Discount,PaymentMethod:e.PaymentMethod}))).sort((e,t)=>Number(t.DatetimeToSort)-Number(e.DatetimeToSort)),this.allPendingOrders=e}))})}ngOnInit(){}addproduct(){this.alertCtrl.create({header:"Choose",inputs:[{type:"radio",label:"POS",value:"POS"},{type:"radio",label:"View Products",value:"View Products"},{type:"radio",label:"Add Product",value:"Add Product"},{type:"radio",label:"Inventory",value:"Inventory"}],buttons:[{text:"Go",handler:e=>{console.log("data",e),"View Products"==e?this.router.navigateByUrl("/viewproducts"):"Add Product"==e?this.router.navigateByUrl("/add-product"):"POS"==e?this.router.navigateByUrl("/createpos"):"Inventory"==e&&this.router.navigateByUrl("/inventory")}},{text:"Cancel",role:"cancel"}]}).then(e=>{e.present()})}closeAccordion(){this.accordionGroup.value=""}toggleSection(){this.accordionGroup.value="frameworks"}approveOrder(e){this.alertCtrl.create({header:"Question",message:"Are you sure you want to approve this order?",buttons:[{text:"Yes",handler:()=>{var t=c(new Date).format("MM-DD-YYYY hh:mm A");this.afstore.doc(`Orders/${e.id}`).update({Status:"Approved"});var n=this.currencyPipe.transform(e.TotalAmount,"",""),r=`Your order has been confirmed by the admin. ${e.OrderDetails.map(function(e){return`${e.ProductName}(${e.Quantity} pcs), Unit price of \u20b1${e.UnitPrice}`}).join(", ")}. Total amount of \u20b1${n}`;this.afstore.collection(`users/${e.BillingIndexId}/notifications`).add({Message:r,Datetime:t,read:!1,remarks:"Your order has been confirmed",DatetimeToSort:new Date,OrderId:e.id}),e.OrderDetails.forEach(e=>{this.afstore.doc(`Products/${e.id}`).update({Stock:d.Z.firestore.FieldValue.increment(-e.Quantity*e.GramsPerOrder)})}),e.OrderDetails.forEach(n=>(0,l.mG)(this,void 0,void 0,function*(){yield this.afstore.collection("Inventory").add({Datetime:t,Category:n.Category,ProductName:n.ProductName,Quantity:-1*parseInt(n.GramsPerOrder),ImageUrl:n.ImageUrl,DatetimeToSort:new Date,ProductId:n.id,Destination:e.BillingFirstname+" "+e.BillingLastname})})),this.afstore.collection("History").add({BillingAddress1:e.BillingAddress1,BillingAddress2:e.BillingAddress2,BillingFirstname:e.BillingFirstname,BillingIndexId:e.BillingIndexId,BillingLastname:e.BillingLastname,BillingPhonenumber:e.BillingPhonenumber,Billingemail:e.Billingemail,Datetime:e.Datetime,Status:"Approved",TotalAmount:e.TotalAmount,id:e.id,OrderDetails:e.OrderDetails,read:!1,DatetimeToSort:new Date,Discount:"None",PaymentMethod:e.PaymentMethod}),this.alertCtrl.create({header:"Success",message:"This order approved successfully",buttons:[{text:"Ok",role:"cancel"}]}).then(e=>{e.present()})}},{text:"No",role:"cancel"}]}).then(e=>{e.present()})}cancelOrder(e){this.alertCtrl.create({header:"Confirmation",message:"Are you sure you want to reject this order?",buttons:[{text:"Yes",handler:()=>{this.alertCtrl.create({header:"Remarks",message:"Please add a remarks why you want to reject this order",inputs:[{name:"remarks",placeholder:"Add a remarks"}],buttons:[{text:"Submit remarks",handler:t=>{var n=c(new Date).format("MM-DD-YYYY hh:mm A");this.afstore.doc(`Orders/${e.id}`).update({Status:"Rejected"});var r=this.currencyPipe.transform(e.TotalAmount,"",""),i=`Your order has been rejected by the admin. ${e.OrderDetails.map(function(e){return`${e.ProductName}(${e.Quantity} pcs), Unit price of \u20b1${e.UnitPrice}`}).join(", ")}. Total amount of \u20b1${r}`;this.afstore.collection(`users/${e.BillingIndexId}/notifications`).add({Message:i,Datetime:n,read:!1,remarks:t.remarks,DatetimeToSort:new Date,OrderId:e.id}),this.afstore.collection("History").add({BillingAddress1:e.BillingAddress1,BillingAddress2:e.BillingAddress2,BillingFirstname:e.BillingFirstname,BillingIndexId:e.BillingIndexId,BillingLastname:e.BillingLastname,BillingPhonenumber:e.BillingPhonenumber,Billingemail:e.Billingemail,Datetime:e.Datetime,Status:"Rejected",TotalAmount:e.TotalAmount,id:e.id,OrderDetails:e.OrderDetails,DatetimeToSort:new Date,Discount:"None",PaymentMethod:e.PaymentMethod}),this.alertCtrl.create({header:"Success",message:"This order rejected successfully",buttons:[{text:"Ok",role:"cancel"}]}).then(e=>{e.present()})}}]}).then(e=>{e.present()})}},{text:"No",role:"cancel"}]}).then(e=>{e.present()})}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(m.ST),u.Y36(g.zQ),u.Y36(a.F0),u.Y36(r.H9),u.Y36(o.Br))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-admintab1"]],viewQuery:function(e,t){if(1&e&&u.Gf(o.eh,5),2&e){let e;u.iGM(e=u.CRH())&&(t.accordionGroup=e.first)}},decls:12,vars:1,consts:[[1,"toolbar"],["slot","end"],[1,"addproduct",3,"click"],["size","large","name","settings"],["hidden","",1,"addproduct"],["size","large","name","text-outline"],["multiple","true"],[4,"ngFor","ngForOf"],["slot","header","lines","none"],["text-wrap","",1,"labelname",2,"font-weight","1000","color","black"],["slot","content",1,"bg-transparent"],["color","none","lines","none",4,"ngFor","ngForOf"],["size","small","color","success",3,"click"],["size","small","color","danger",3,"click"],["color","none","lines","none"],["slot","start"],[3,"src"],[2,"font-weight","bolder"],[2,"font-weight","1000","color","white"]],template:function(e,t){1&e&&(u.TgZ(0,"ion-header"),u.TgZ(1,"ion-toolbar",0),u.TgZ(2,"ion-buttons",1),u.TgZ(3,"ion-button",2),u.NdJ("click",function(){return t.addproduct()}),u._UZ(4,"ion-icon",3),u.qZA(),u.TgZ(5,"ion-button",4),u._UZ(6,"ion-icon",5),u.qZA(),u.qZA(),u.TgZ(7,"ion-title"),u._uU(8,"All Orders"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(9,"ion-content"),u.TgZ(10,"ion-accordion-group",6),u.YNc(11,p,25,13,"ion-accordion",7),u.qZA(),u.qZA()),2&e&&(u.xp6(11),u.Q6J("ngForOf",t.allPendingOrders))},directives:[o.Gu,o.sr,o.Sm,o.YG,o.gu,o.wd,o.W2,o.eh,r.sg,o.We,o.Ie,o.Q$,o.q_,o.BJ],pipes:[r.H9],styles:[".toolbar[_ngcontent-%COMP%]{height:84px;--background:#69a03a;color:#fff;font-size:20px;line-height:84px}.addproduct[_ngcontent-%COMP%]{cursor:pointer}.addproduct[_ngcontent-%COMP%]:active{color:red}.labeldate[_ngcontent-%COMP%]{font-family:Verdana,Geneva,Tahoma,sans-serif;font-weight:900}.labelname[_ngcontent-%COMP%]{font-family:Trebuchet MS,Lucida Sans Unicode,Lucida Grande,Lucida Sans,Arial,sans-serif;font-weight:900;font-size:18px;color:#2f0101}.totalamount[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif;font-weight:bolder}ion-accordion.accordion-expanded[_ngcontent-%COMP%]   ion-item[slot=header][_ngcontent-%COMP%]{--background:url(backgroundimage.35be21de00795f69fb68.jpg) no-repeat center center/cover;--background-color:#0000}ion-accordion.accordion-collapsed[_ngcontent-%COMP%]   ion-item[slot=header][_ngcontent-%COMP%]{--background:url(backgroundimage3.5f20fa4f128f1fd27053.jpg) no-repeat center center/cover;--background-color:#0000}ion-accordion.accordion-expanded[_ngcontent-%COMP%]   [slot=content][_ngcontent-%COMP%], ion-accordion.accordion-expanding[_ngcontent-%COMP%]   [slot=content][_ngcontent-%COMP%]{--ion-item-background:url(backgroundimage2.2480a2c01d0396aec9a7.jpg) no-repeat center center/cover}"]}),e})()}];let b=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[a.Bz.forChild(f)],a.Bz]}),e})(),A=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[r.ez,i.u5,o.Pc,b]]}),e})()}}]);