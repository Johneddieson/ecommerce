(self.webpackChunkcom_trackingsystem=self.webpackChunkcom_trackingsystem||[]).push([[6976],{6976:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AdmincheckoutPageModule:()=>Z});var i=n(8583),o=n(665),a=n(5214),r=n(6476),s=n(4762),l=n(6738),c=n(2329),g=n(3018),h=n(1562),d=n(7810),u=n(1423);function m(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"ion-item"),g.TgZ(1,"ion-thumbnail",1),g._UZ(2,"img",12),g.qZA(),g.TgZ(3,"ion-label"),g.TgZ(4,"h2"),g._uU(5),g.TgZ(6,"span",13),g._uU(7),g.ALo(8,"currency"),g.qZA(),g.qZA(),g.TgZ(9,"p",14),g._uU(10),g.qZA(),g.TgZ(11,"div",15),g._UZ(12,"span",16),g._uU(13),g._UZ(14,"span",17),g.TgZ(15,"span",18),g.TgZ(16,"button",19),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw().singleDelete(e)}),g._uU(17," Remove"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit;g.xp6(2),g.s9C("src",t.ImageUrl,g.LSH),g.xp6(3),g.hij("",t.ProductName," "),g.xp6(2),g.Oqu(g.xi3(8,5,t.UnitPrice,"\u20b1")),g.xp6(3),g.hij(" ",t.Stock," remaining stock"),g.xp6(3),g.hij(" ",t.Quantity," ")}}function p(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"ion-button",4),g.NdJ("click",function(){return g.CHM(t),g.oxw().OrderNow()}),g._uU(1,"Confirm Order"),g.qZA()}}const C=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o,a){this.alertCtrl=t,this.locationStrategy=e,this.router=n,this.afauth=i,this.afstore=o,this.msg=a,this.getCartDetails=[],this.getCurrentProductDetails=[],this.total=0,this.subtotal=0,this.cartItem=0,this.getOrders=[],this.myInformation={},this.discount="None",this.paymentMethod="",this.afauth.authState.subscribe(t=>{})}ngOnInit(){this.msg.cartSubject.next(this.CartDetails()),this.msg.cartSubject.next(this.loadCart())}CartDetails(){sessionStorage.getItem("cart")&&(this.getCartDetails=JSON.parse(sessionStorage.getItem("cart")))}inc(t,e){for(let n=0;n<this.getCartDetails.length;n++)this.getCartDetails[n].id===t&&(this.getCartDetails[n].Quantity=e+1);sessionStorage.setItem("cart",JSON.stringify(this.getCartDetails)),this.loadCart()}dec(t,e){for(let n=0;n<this.getCartDetails.length;n++)this.getCartDetails[n].id===t&&1!=e&&(this.getCartDetails[n].Quantity=e-1);sessionStorage.setItem("cart",JSON.stringify(this.getCartDetails)),this.loadCart()}loadCart(){sessionStorage.getItem("cart")&&(this.getCartDetails=JSON.parse(sessionStorage.getItem("cart")),this.total=this.getCartDetails.reduce((t,e)=>t+e.UnitPrice*e.Quantity,0))}removeall(){sessionStorage.removeItem("cart"),this.getCartDetails=[],this.total=0,this.cartItem=0,this.msg.cartSubject.next(this.cartItem),this.loadCart()}singleDelete(t){if(sessionStorage.getItem("cart")){this.getCartDetails=JSON.parse(sessionStorage.getItem("cart"));for(let e=0;e<this.getCartDetails.length;e++)this.getCartDetails[e].id===t.id&&(this.getCartDetails.splice(e,1),sessionStorage.setItem("cart",JSON.stringify(this.getCartDetails)),this.loadCart(),this.cartItemFunc())}}cartItemFunc(){var t=JSON.parse(sessionStorage.getItem("cart"));this.cartItem=t.length,this.msg.cartSubject.next(this.cartItem)}gotohome(){this.router.navigate(["tabs"])}OrderNow(){return(0,s.mG)(this,void 0,void 0,function*(){this.CartDetails();let t=this.getCartDetails.length>1?"orders":"order",e="";if(""==this.paymentMethod){var n=yield this.alertCtrl.create({message:"Payment Method is required",buttons:[{text:"Ok",role:"cancel"}]});yield n.present()}else this.alertCtrl.create({message:"Are you sure you want to approve this order?",buttons:[{text:"Ok",handler:()=>{this.alertCtrl.create({header:"Customer Name",inputs:[{name:"Name",placeholder:"Customer Name",type:"text"}],buttons:[{text:"Ok",handler:n=>{n.Name&&null!=n.Name?n.Name.length<2?alert("Name of customer should be two characters minimum"):this.alertCtrl.create({message:`${n.Name} ${t} has been approved!`,buttons:[{text:"Ok",role:"cancel"}]}).then(t=>{t.present();var i=l(new Date).format("MM-DD-YYYY hh:mm A");this.afstore.collection("Orders").add({OrderDetails:this.getCartDetails,BillingFirstname:n.Name,BillingLastname:"Walk-In",BillingAddress1:"Walk-In",BillingAddress2:"Walk-In",BillingPhonenumber:"Walk-In",Billingemail:"Walk-In",BillingIndexId:"",Status:"Approved",Datetime:i,TotalAmount:parseFloat(this.total.toString()).toFixed(2),DatetimeToSort:new Date,Discount:this.discount,PaymentMethod:this.paymentMethod}).then(t=>{e=t.id}).catch(t=>{}),this.getCartDetails.forEach(t=>{this.afstore.doc(`Products/${t.id}`).update({Stock:c.Z.firestore.FieldValue.increment(-t.Quantity*t.GramsPerOrder)})}),this.getCartDetails.forEach(t=>(0,s.mG)(this,void 0,void 0,function*(){yield this.afstore.collection("Inventory").add({Datetime:i,Category:t.Category,ProductName:t.ProductName,Quantity:-1*parseInt(t.GramsPerOrder),ImageUrl:t.ImageUrl,DatetimeToSort:new Date,ProductId:t.id,Destination:n.Name})})),this.afstore.collection("History").add({BillingAddress1:"Walk-In",BillingAddress2:"Walk-In",BillingFirstname:n.Name,BillingIndexId:"",BillingLastname:"Walk-In",BillingPhonenumber:"Walk-In",Billingemail:"Walk-In",Datetime:i,Status:"Approved",TotalAmount:parseFloat(this.total.toString()).toFixed(2),id:e,OrderDetails:this.getCartDetails,read:!1,DatetimeToSort:new Date,Discount:this.discount,PaymentMethod:this.paymentMethod}),this.removeall(),this.discount="None",this.paymentMethod=""}):alert("Name of customer is required")}},{text:"Cancel",handler:t=>{}}]}).then(t=>{t.present()})}},{text:"Cancel",role:"cancel"}]}).then(t=>{t.present()})})}selectDiscount(){return(0,s.mG)(this,void 0,void 0,function*(){var t=yield this.alertCtrl.create({header:"Select discount category",inputs:[{type:"radio",label:"None",name:"None",value:"None"},{type:"radio",label:"PWD less 30",name:"PWD less 30",value:"PWD less 30"},{type:"radio",label:"Senior Citizen less 50",name:"Senior Citizen less 50",value:"Senior Citizen less 50"}],buttons:[{text:"Select",handler:t=>{"Senior Citizen less 50"==t?(this.discount="",this.loadCart(),this.total=this.total-50,this.discount=t):"PWD less 30"==t?(this.discount="",this.loadCart(),this.total=this.total-30,this.discount=t):(this.discount="",this.loadCart(),this.discount=t)}},{text:"Close",role:"cancel"}]});yield t.present()})}selectPaymentMethod(){return(0,s.mG)(this,void 0,void 0,function*(){var t=yield this.alertCtrl.create({header:"Select Payment Method",inputs:[{type:"radio",name:"G-Cash",value:"G-Cash",label:"G-Cash"},{type:"radio",name:"Cash",value:"Cash",label:"Cash"}],buttons:[{text:"Select",handler:t=>{this.paymentMethod="",this.paymentMethod=t}},{text:"Close",role:"cancel"}]});yield t.present()})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(a.Br),g.Y36(i.S$),g.Y36(r.F0),g.Y36(h.zQ),g.Y36(d.ST),g.Y36(u.g))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admincheckout"]],decls:29,vars:7,consts:[[1,"toolbar"],["slot","start"],["name","arrow-back-outline","slot","icon-only","routerLink","/createpos",2,"cursor","pointer"],["slot","end"],["color","light",3,"click"],[1,"discount"],[1,"paymentMethod"],[1,"container"],[4,"ngFor","ngForOf"],["size","7"],["size","5"],["color","light",3,"click",4,"ngIf"],[3,"src"],[2,"float","right","color","#69a03a"],[1,"rate"],["id","qty"],[1,"minus"],[1,"plus"],[2,"float","right"],["id","btn",3,"click"]],template:function(t,e){1&t&&(g.TgZ(0,"ion-header"),g.TgZ(1,"ion-toolbar",0),g.TgZ(2,"ion-buttons",1),g._UZ(3,"ion-icon",2),g.qZA(),g.TgZ(4,"ion-title"),g._uU(5,"Check Out"),g.qZA(),g.TgZ(6,"ion-buttons",3),g.TgZ(7,"ion-button",4),g.NdJ("click",function(){return e.selectDiscount()}),g._UZ(8,"img",5),g.qZA(),g.TgZ(9,"ion-button",4),g.NdJ("click",function(){return e.selectPaymentMethod()}),g._UZ(10,"img",6),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(11,"ion-content"),g.TgZ(12,"div",7),g.TgZ(13,"ion-grid"),g.TgZ(14,"ion-row"),g.TgZ(15,"ion-col"),g.TgZ(16,"ion-list"),g.YNc(17,m,18,8,"ion-item",8),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(18,"ion-footer"),g.TgZ(19,"ion-row"),g.TgZ(20,"ion-col",9),g.TgZ(21,"ion-text"),g.TgZ(22,"h4"),g._uU(23),g.ALo(24,"currency"),g.qZA(),g.TgZ(25,"h4"),g._uU(26),g.qZA(),g.qZA(),g.qZA(),g.TgZ(27,"ion-col",10),g.YNc(28,p,2,0,"ion-button",11),g.qZA(),g.qZA(),g.qZA()),2&t&&(g.xp6(17),g.Q6J("ngForOf",e.getCartDetails),g.xp6(6),g.hij("Total : ",g.xi3(24,4,e.total,"\u20b1")," "),g.xp6(3),g.hij("Payment Method : ",e.paymentMethod," "),g.xp6(2),g.Q6J("ngIf",e.total>0))},directives:[a.Gu,a.sr,a.Sm,a.gu,a.YI,r.rH,a.wd,a.YG,a.W2,a.jY,a.Nd,a.wI,a.q_,i.sg,a.fr,a.yW,i.O5,a.Ie,a.Bs,a.Q$],pipes:[i.H9],styles:[".discount[_ngcontent-%COMP%]{content:url(https://cdn-icons-png.flaticon.com/512/272/272535.png);width:1.5rem}.paymentMethod[_ngcontent-%COMP%]{content:url(https://cdn-icons-png.flaticon.com/512/671/671517.png);width:1.5rem}.toolbar[_ngcontent-%COMP%]{height:84px;--background:#69a03a;color:#fff;font-size:20px;line-height:84px}.buttonsactive[_ngcontent-%COMP%]:active{background-color:red;font-weight:500}.container[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{width:100px!important;height:100px!important}.container[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:10px}.container[_ngcontent-%COMP%]   .rate[_ngcontent-%COMP%]{color:#ccc}.container[_ngcontent-%COMP%]   #qty[_ngcontent-%COMP%]{margin-top:5px}.container[_ngcontent-%COMP%]   #qty[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%]{font-weight:600;padding:5px;margin-right:20px;cursor:pointer}.container[_ngcontent-%COMP%]   #qty[_ngcontent-%COMP%]   .plus[_ngcontent-%COMP%]{margin-left:20px;font-weight:600;padding:5px;cursor:pointer}.container[_ngcontent-%COMP%]   #qty[_ngcontent-%COMP%]   #btn[_ngcontent-%COMP%]{padding:10px 20px;color:#fff;background-color:red}.container[_ngcontent-%COMP%]   #qty[_ngcontent-%COMP%]   #btn[_ngcontent-%COMP%]:active{background-color:#051542}.container[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin:10px;color:#69a03a}ion-footer[_ngcontent-%COMP%]{--background:#69a03a}ion-footer[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{background:#69a03a;color:#fff}ion-footer[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]:last-child{text-align:end}"]}),t})()}];let f=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[r.Bz.forChild(C)],r.Bz]}),t})(),Z=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[i.ez,o.u5,a.Pc,f]]}),t})()}}]);