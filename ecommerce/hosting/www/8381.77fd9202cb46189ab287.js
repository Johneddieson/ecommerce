(self.webpackChunkcom_trackingsystem=self.webpackChunkcom_trackingsystem||[]).push([[8381],{8381:(e,t,i)=>{"use strict";i.r(t),i.d(t,{Tab2PageModule:()=>y});var n=i(5214),o=i(8583),s=i(665),r=i(581),a=i(6476),c=i(4762),d=i(6738),l=i(8002),u=i(3018),h=i(7810),f=i(1562),m=i(3388);function g(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"ion-button",10),u.NdJ("click",function(){u.CHM(e);const t=u.oxw().$implicit;return u.oxw().sendFeedBack(t)}),u.TgZ(1,"p"),u._uU(2,"Send Feedback"),u.qZA(),u.qZA()}}function b(e,t){if(1&e&&(u.TgZ(0,"ion-card",2),u.TgZ(1,"ion-card-header",3),u.TgZ(2,"ion-card-subtitle",4),u._uU(3),u.qZA(),u.TgZ(4,"ion-item",5),u.TgZ(5,"ion-label",6),u._uU(6),u.qZA(),u.qZA(),u.qZA(),u.TgZ(7,"ion-card-content",7),u.TgZ(8,"ion-label",8),u._uU(9),u.qZA(),u.qZA(),u.TgZ(10,"ion-row"),u.YNc(11,g,3,0,"ion-button",9),u.qZA(),u.qZA()),2&e){const e=t.$implicit;u.xp6(3),u.hij(" Remarks: ",e.remarks," "),u.xp6(3),u.Oqu(e.Message),u.xp6(3),u.hij("Due ",e.Datetime,""),u.xp6(2),u.Q6J("ngIf",!e.read)}}const p=[{path:"",component:(()=>{class e{constructor(e,t,i,n,o,s,r,a,d){this.router=e,this.afstore=t,this.afauth=i,this.loadingCtrl=n,this.locationStrategy=o,this.auth=s,this.alertCtrl=r,this.applicationRef=a,this.zone=d,this.notificationsList=[],this.notifCounts=0,this.afauth.authState.subscribe(e=>{e&&e.uid&&(this.myid=e.uid,this.notificationsReference=this.afstore.collection(`users/${e.uid}/notifications`),this.sub=this.notificationsReference.snapshotChanges().pipe((0,l.U)(e=>e.map(e=>Object.assign({id:e.payload.doc.id},e.payload.doc.data())))).subscribe(e=>(0,c.mG)(this,void 0,void 0,function*(){e=(e=e.map((e,t)=>Object.assign({id:e.id,Datetime:e.Datetime,DatetimeToSort:e.DatetimeToSort,read:e.read,remarks:e.remarks,Message:e.Message,OrderId:e.OrderId}))).sort((e,t)=>Number(t.DatetimeToSort)-Number(e.DatetimeToSort)),this.notificationsList=e;var t=e.filter(e=>1!=e.read);this.notifCounts=t.length})),this.meReference=this.afstore.doc(`users/${e.uid}`),this.subMeReference=this.meReference.valueChanges().subscribe(e=>{this.email=e.Email}))})}ngOnInit(){return(0,c.mG)(this,void 0,void 0,function*(){var e=yield this.alertCtrl.create({message:"You can send your feedback to us, we will appreciate your comments thanks!",buttons:[{text:"Ok",role:"cancel"}]});yield e.present()})}update(e){console.log("edited",this.myid),this.afstore.doc(`users/${this.myid}/notifications/${e.id}`).update({read:!0})}sendFeedBack(e){return(0,c.mG)(this,void 0,void 0,function*(){var t=d(new Date).format("MM-DD-YYYY hh:mm A"),i=yield this.alertCtrl.create({header:"Send your feedback to this order",inputs:[{type:"textarea"}],buttons:[{text:"Send",handler:i=>(0,c.mG)(this,void 0,void 0,function*(){var n=yield this.alertCtrl.create({message:"Are you sure you want to send your feedback to this order?",buttons:[{text:"Yes",handler:()=>{this.OrderDocuments=this.afstore.doc(`Orders/${e.OrderId}`),this.OrderDocuments.get().pipe((0,l.U)(e=>Object.assign({id:e.id},e.data()))).subscribe(n=>{this.afstore.collection("FeedBacks").add({Message:i,DateTime:t,DateTimeToSort:new Date,Read:!1,Email:this.email,Orders:n.OrderDetails}).then(t=>(0,c.mG)(this,void 0,void 0,function*(){this.afstore.doc(`users/${this.myid}/notifications/${e.id}`).update({read:!0});var t=yield this.alertCtrl.create({message:"Feedback sent successfully!",buttons:[{text:"Ok",role:"cancel"}]});yield t.present()}))})}},{text:"No",role:"cancel"}]});yield n.present()})},{text:"Close",role:"cancel"}]});yield i.present()})}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(a.F0),u.Y36(h.ST),u.Y36(f.zQ),u.Y36(n.HT),u.Y36(o.S$),u.Y36(m.u),u.Y36(n.Br),u.Y36(u.z2F),u.Y36(u.R0b))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-tab2"]],decls:2,vars:2,consts:[[3,"fullscreen"],["class","ion-margin",4,"ngFor","ngForOf"],[1,"ion-margin"],[1,"ion-header"],[1,"ion-subtitle",2,"font-weight","bolder","color","black"],["color","none","lines","none"],["text-wrap","",1,"label",2,"font-weight","bolder","color","black"],[2,"font-weight","bolder"],[2,"font-weight","bolder","color","black"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,t){1&e&&(u.TgZ(0,"ion-content",0),u.YNc(1,b,12,4,"ion-card",1),u.qZA()),2&e&&(u.Q6J("fullscreen",!0),u.xp6(1),u.Q6J("ngForOf",t.notificationsList))},directives:[n.W2,o.sg,n.PM,n.Zi,n.tO,n.Ie,n.Q$,n.FN,n.Nd,o.O5,n.YG],styles:["ion-content[_ngcontent-%COMP%]{background:linear-gradient(120deg,#2980b9,#8e44ad);--background:url(backgroundimage3.5f20fa4f128f1fd27053.jpg) no-repeat center center/cover}.ion-header[_ngcontent-%COMP%], .ion-margin[_ngcontent-%COMP%], .ion-subtitle[_ngcontent-%COMP%], .label[_ngcontent-%COMP%]{background-color:initial}"]}),e})()}];let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[a.Bz.forChild(p)],a.Bz]}),e})(),y=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[n.Pc,o.ez,s.u5,r.e,k]]}),e})()}}]);